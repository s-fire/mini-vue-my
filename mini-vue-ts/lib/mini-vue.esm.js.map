{"version":3,"file":"mini-vue.esm.js","sources":["../src/shared/index.ts","../src/runtime-core/component.ts","../src/runtime-core/render.ts","../src/runtime-core/vnode.ts","../src/runtime-core/createApp.ts","../src/runtime-core/h.ts"],"sourcesContent":["export const isObject = (val) => {\n  return val !== null && typeof val === \"object\";\n};\nexport const extend = Object.assign;\n\nexport function hasChanged(val, newValue) {\n  return !Object.is(val, newValue);\n}\n","export function createComponentInstance(vnode) {\n  const component = {\n    vnode,\n    type:vnode.type\n  }\n  return component\n}\nexport function setupComponent(instance: { vnode: any }) {\n  /* \n    instance{  // 组件实例\n      vnode{  // 组件虚拟节点\n        type // 传入的App组件配置\n      } \n      type // 传入的App组件配置\n    }\n  */\n  // 实例化有状态组件\n  setupStatefulComponent(instance)\n}\n\nfunction setupStatefulComponent(instance: any) {\n  /* \n    instance{  // 组件实例\n      vnode{  // 组件虚拟节点\n        type // 传入的App组件配置\n      } \n      type // 传入的App组件配置\n    }\n  */\n  const Component = instance.type // 传入的App配置\n  // 取到App里的setup函数\n  const {setup} = Component\n  if (setup) {\n    const setupResult = setup()\n    handleSetupResult(instance,setupResult)\n  }\n}\nfunction handleSetupResult(instance,setupResult: any) {\n  // setup函数有可能返回函数或者对象\n  if (typeof(setupResult) === 'object') {\n    // 把setup返回的对象保存到实例上\n    instance.setupState = setupResult\n  }\n  finishComponentSetup(instance)\n}\n\nfunction finishComponentSetup(instance: any) {\n  const Component = instance.type\n  if (Component.render) {\n    instance.render =Component.render\n  }\n}\n\n","import { isObject } from \"../shared\";\nimport { createComponentInstance, setupComponent } from \"./component\";\n\nexport function render(vnode, container) {\n  patch(vnode, container);\n}\nfunction patch(vnode, container) {\n  if (typeof vnode.type === \"string\") {\n    // 处理元素\n    processElement(vnode, container);\n  } else if (isObject(vnode.type)) {\n    // 处理组件\n    processComponent(vnode, container);\n  }\n}\nfunction processElement(vnode: any, container: any) {\n  // 初始化元素\n  mountElement(vnode, container);\n}\nfunction mountElement(vnode: any, container: any) {\n  const el:HTMLElement = document.createElement(vnode.type);\n  const { children } = vnode;\n  if (typeof children === \"string\") {\n    // 文本内容直接设置\n    el.textContent = children;\n  } else if (Array.isArray(children)) {\n    // 数组类型 遍历后调用Patch\n    mountChildren(vnode, el);\n  }\n  // 处理props属性\n  const { props } = vnode;\n  for (const key in props) {\n    const element = props[key];\n    el.setAttribute(key, element);\n  }\n  container.append(el);\n}\nfunction mountChildren(vnode: any, el: HTMLElement) {\n  vnode.children.forEach((element) => {\n    patch(element, el);\n  });\n}\n\n// 处理组件\nfunction processComponent(vnode: any, container: any) {\n  // 挂载组件\n  mountComponent(vnode, container);\n}\n// 挂载组件\nfunction mountComponent(vnode: any, container) {\n  // 创建组件实例\n  const instance = createComponentInstance(vnode);\n  setupComponent(instance);\n  setupRederEffect(instance, container);\n}\n\nfunction setupRederEffect(instance: any, container) {\n  const subTree = instance.render();\n  // subTree h函数返回的内容\n  patch(subTree, container);\n}\n","export function createVnode(type,props?,children?) {\n  // type传入的App配置\n  return {\n    type,\n    props,\n    children\n  }\n  \n}","import { render } from \"./render\"\nimport { createVnode } from \"./vnode\"\n\nexport function createApp(rootComponent){\n  // 传入的App配置\n  return {\n    mount(rootContainer){\n      // 转换成虚拟节点\n      // component -> vnode\n      const vnode = createVnode(rootComponent)\n      render(vnode,rootContainer)\n    }\n  }\n}\n","import { createVnode } from \"./vnode\";\nexport function h(type,props?,children?) {\n  return createVnode(type,props,children)\n}"],"names":[],"mappings":"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"}